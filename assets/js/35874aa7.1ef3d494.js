"use strict";(self.webpackChunkcurator_site=self.webpackChunkcurator_site||[]).push([[6973],{1471:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"tech-note-13","title":"Tech Note 13","description":"Guava usage in Curator","source":"@site/docs/tech-note-13.md","sourceDirName":".","slug":"/tech-note-13","permalink":"/docs/tech-note-13","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/curator-site/tree/main/docs/tech-note-13.md","tags":[],"version":"current","lastUpdatedBy":"tison","lastUpdatedAt":1741315398000,"frontMatter":{},"sidebar":"docs","previous":{"title":"Tech Note 12","permalink":"/docs/tech-note-12"},"next":{"title":"Tech Note 14","permalink":"/docs/tech-note-14"}}');var n=s(5105),o=s(3881);const r={},i="Tech Note 13",c={},l=[{value:"Details",id:"details",level:2},{value:"Shaded But Not Gone",id:"shaded-but-not-gone",level:3},{value:"Summary",id:"summary",level:2},{value:"Test",id:"test",level:2},{value:"Comment",id:"comment",level:2}];function u(e){const t={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"tech-note-13",children:"Tech Note 13"})}),"\n",(0,n.jsx)(t.p,{children:"Guava usage in Curator"}),"\n",(0,n.jsx)(t.h2,{id:"details",children:"Details"}),"\n",(0,n.jsxs)(t.p,{children:["Since Curator was created at Netflix it has used Google's popular Guava library. Due to the many versions of Guava used in projects that also use Curator there has always been the potential for conflicts. Recent versions of Guava removed some APIs that Curator uses internally and Curator users were getting ClassNotFoundException, etc. ",(0,n.jsx)(t.a,{href:"https://issues.apache.org/jira/browse/CURATOR-200",children:"CURATOR-200"})," addresses these issues by shading Guava into Curator."]}),"\n",(0,n.jsx)(t.h3,{id:"shaded-but-not-gone",children:"Shaded But Not Gone"}),"\n",(0,n.jsx)(t.p,{children:"Unfortunately, a few of Curator's public APIs use Guava classes (e.g. ListenerContainer's use of Guava's Function). Breaking public APIs would cause as much harm as solving the Guava problem. So, it was decided to shade all Guava except for these three classes:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"com.google.common.base.Function"}),"\n",(0,n.jsx)(t.li,{children:"com.google.common.base.Predicate"}),"\n",(0,n.jsx)(t.li,{children:"com.google.common.reflect.TypeToken"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The implication of this is that Curator still has a hard dependency on Guava but only for these three classes. What this means for Curator users is that you can use whatever version of Guava your project needs without concern about ClassNotFoundException, NoSuchMethodException, etc."}),"\n",(0,n.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"All but three Guava classes are completed shaded into Curator"}),"\n",(0,n.jsx)(t.li,{children:"Curator still has a hard dependency on Guava, but you should be able to use whatever version of Guava your project needs"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"test",children:"Test"}),"\n",(0,n.jsxs)(t.p,{children:["Note, this project proves the shaded version of Guava: ",(0,n.jsx)(t.a,{href:"https://github.com/Randgalt/curator-guava-example",children:"https://github.com/Randgalt/curator-guava-example"})]}),"\n",(0,n.jsx)(t.h2,{id:"comment",children:"Comment"}),"\n",(0,n.jsx)(t.p,{children:"For those still not convinced. Here's a disassembly of ListenerContainer.class from Curator 3.3.0. You can see that various Guava classes like MoreExecutors are shaded."}),"\n",(0,n.jsxs)(t.p,{children:["Disassembly: ",(0,n.jsx)(t.a,{href:"https://gist.github.com/Randgalt/3fcdca337a2f8527a3f7ee871852f456",children:"https://gist.github.com/Randgalt/3fcdca337a2f8527a3f7ee871852f456"})]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},3881:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>i});var a=s(8101);const n={},o=a.createContext(n);function r(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);